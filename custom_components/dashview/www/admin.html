<p>This is the central place for administrative tasks and advanced settings.</p>

<div class="tabs-container" style="margin-top: 20px;">
    <div class="tab-buttons">
        <button class="tab-button active" data-target="weather-tab">Weather</button>
        <button class="tab-button" data-target="house-setup-tab">House Setup</button>
        <button class="tab-button" data-target="sensor-management-tab">Sensor Management</button>
        <button class="tab-button" data-target="device-management-tab">Device Management</button>
        <button class="tab-button" data-target="room-maintenance-tab">Room Maintenance</button>
        <button class="tab-button" data-target="integrations-tab">Integrations</button>
        <button class="tab-button" data-target="floor-layouts-tab">Floor Layouts</button>
        <button class="tab-button" data-target="scenes-tab">Scenes</button>
        <button class="tab-button" data-target="media-presets-tab">Media Presets</button>
        <button class="tab-button" data-target="other-entities-tab">Other Entities</button>
        <button class="tab-button" data-target="garbage-tab">Garbage</button>
    </div>
    <div id="scenes-tab" class="tab-content">
        <h4>Scene Button Management</h4>
        <p>Create and manage your custom scene buttons here.</p>
        
        <!-- Auto-Generated Scenes Section -->
        <div class="config-section">
            <h5>Auto-Generated Scenes</h5>
            <p>Automatically create scene buttons that appear in rooms with the relevant entities.</p>
            
            <div class="setting-row">
                <label class="toggle-container">
                    <input type="checkbox" id="auto-light-scenes-enabled" checked>
                    <span class="toggle-slider"></span>
                    <span class="toggle-label">Enable "Lights Off" scenes in all rooms with lights</span>
                </label>
            </div>
            
            <div class="setting-row">
                <label class="toggle-container">
                    <input type="checkbox" id="global-cover-scene-enabled" checked>
                    <span class="toggle-slider"></span>
                    <span class="toggle-label">Enable Global Cover Scene</span>
                </label>
            </div>
            
            <div id="auto-scenes-status" class="status-display">Ready</div>
            
            <div class="form-row" style="margin-top: 12px;">
                <button id="save-auto-scenes" class="action-button">Save Settings</button>
            </div>
        </div>

        <div class="config-section">
            <h5>Manual Scene Buttons</h5>
            <div id="scenes-status" class="status-display">Ready</div>
            <div id="scenes-list" class="floors-container">
                </div>
            <div class="form-row" style="margin-top: 20px; display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
                <input type="text" id="new-scene-name" class="form-input" placeholder="Scene Name (e.g., Ambiente)">
                <input type="text" id="new-scene-id" class="form-input" placeholder="Unique ID (e.g., wohnzimmer_ambiente)">
                <input type="text" id="new-scene-icon" class="form-input" placeholder="Icon (e.g., mdi:sofa)">
                <select id="new-scene-type" class="dropdown-selector">
                    <option value="default">Default</option>
                    <option value="cover">Cover</option>
                    <option value="all_covers">All Covers</option>
                    <option value="roof_window">Roof Window</option>
                    <option value="dimm_desk">Dimmable Desk</option>
                    <option value="computer">Computer</option>
                    <option value="all_lights_out">All Lights Out</option>
                </select>
                <textarea id="new-scene-entities" class="config-textarea" placeholder="Entities (one per line)" style="grid-column: 1 / -1;"></textarea>
            </div>
            <button id="add-scene" class="action-button">Add Scene</button>
            <button id="save-scenes" class="save-button" style="margin-top: 20px;">Save All Scenes</button>
        </div>
    </div>
    <div id="weather-tab" class="tab-content active">
        <h4>Weather Entity</h4>
        <p>Select the primary weather entity to be used across the dashboard.</p>
        <div id="weather-status" class="status-display">Ready</div>
        <div class="setting-row">
            <select id="weather-entity-selector" class="dropdown-selector"></select>
            <button id="save-weather-entity" class="save-button">Save</button>
            <button id="reload-weather-config" class="action-button">Reload</button>
        </div>
    </div>
    <div id="floor-layouts-tab" class="tab-content">
        <h4>Floor Layout Editor</h4>
        <p>Configure the small sensor card slots for each floor. Choose between "Automatic" (smart ranking based on usage), "Pinned" (always show a specific sensor), or "Empty".</p>
        <div id="floor-layout-editor-container">
            <!-- The editor will be dynamically generated here -->
            <div class="placeholder">Loading layout editor...</div>
        </div>
        <button id="save-floor-layouts" class="save-button" style="margin-top: 20px;">Save Layouts</button>
        <div id="floor-layouts-status" class="status-display" style="margin-top: 10px;">Ready</div>
    </div>
    <div id="house-setup-tab" class="tab-content">
        <h4>House Setup Configuration</h4>
        <p>Configure your house with unified room and floor settings. This is the modern way to configure DashView.</p>
        
        <div class="config-section">
            <h5>House Configuration Status</h5>
            <div id="house-config-status" class="status-display">Loading...</div>
            <button id="reload-house-config" class="action-button">Reload House Configuration</button>
        </div>
        
        <div class="config-section">
            <h5>House Setup Configuration</h5>
            <p>Each room contains its friendly name, icon, floor assignment, combined sensor, and placeholders for lights, covers, and media players.</p>
            <textarea id="house-config" class="config-textarea" placeholder="House configuration will be loaded here..."></textarea>
            <button id="save-house-config" class="save-button">Save House Config</button>
        </div>
    </div>
    <div id="media-presets-tab" class="tab-content">
        <h4>Media Player Presets</h4>
        <p>Manage the playlist presets that appear in your media player cards.</p>
        <div class="config-section">
            <h5>Preset Management</h5>
            <div id="media-presets-status" class="status-display">Ready</div>
            <div id="media-presets-list" class="floors-container">
                </div>
            <div class="form-row" style="margin-top: 20px;">
                <input type="text" id="new-preset-name" class="form-input" placeholder="Preset Name (e.g., Dinner Jazz)">
                <input type="text" id="new-preset-id" class="form-input" placeholder="Content ID (e.g., spotify:playlist:...)">
                <button id="add-media-preset" class="action-button">Add Preset</button>
            </div>
            <button id="save-media-presets" class="save-button" style="margin-top: 20px;">Save All Presets</button>
        </div>
    </div>
    <div id="sensor-management-tab" class="tab-content">
        <h4>Sensor Management</h4>
        <p>Configure all sensor types from Home Assistant. Manage motion, window, smoke detector, vibration, door, temperature, and humidity sensors in one place.</p>
        
        <!-- Motion Sensors Section -->
        <div class="config-section">
            <h5>Motion Sensors</h5>
            <p>Configure motion sensors based on Home Assistant labels. Select motion sensors labeled "Motion" to assign to rooms.</p>
            <div id="motion-setup-status" class="status-display">Ready</div>
            <button id="reload-motion-sensors" class="action-button">Reload Motion Sensors</button>
            <div id="motion-sensors-by-room" class="floors-container">
            </div>
            <button id="save-motion-sensor-config" class="save-button" style="margin-top: 12px;">Save Motion Sensor Configuration</button>
        </div>
        
        <!-- Window Sensors Section -->
        <div class="config-section">
            <h5>Window Sensors</h5>
            <p>Configure window sensors based on Home Assistant labels. Select window sensors labeled "Fenster" to assign to rooms.</p>
            <div id="window-setup-status" class="status-display">Ready</div>
            <button id="reload-window-sensors" class="action-button">Reload Window Sensors</button>
            <div id="window-sensors-by-room" class="floors-container">
            </div>
            <button id="save-window-sensor-config" class="save-button" style="margin-top: 12px;">Save Window Sensor Configuration</button>
        </div>
        
        <!-- Smoke Detector Section -->
        <div class="config-section">
            <h5>Smoke Detectors</h5>
            <p>Configure smoke detector sensors based on Home Assistant labels. Select smoke detectors labeled "Rauchmelder" to assign to rooms.</p>
            <div id="smoke-detector-setup-status" class="status-display">Ready</div>
            <button id="reload-smoke-detector-sensors" class="action-button">Reload Smoke Detectors</button>
            <div id="smoke-detector-sensors-by-room" class="floors-container">
            </div>
            <button id="save-smoke-detector-sensor-config" class="save-button" style="margin-top: 12px;">Save Smoke Detector Configuration</button>
        </div>
        
        <!-- Vibration Sensors Section -->
        <div class="config-section">
            <h5>Vibration Sensors</h5>
            <p>Configure vibration sensors based on Home Assistant labels. Select vibration sensors labeled "Vibration" to assign to rooms.</p>
            <div id="vibration-setup-status" class="status-display">Ready</div>
            <button id="reload-vibration-sensors" class="action-button">Reload Vibration Sensors</button>
            <div id="vibration-sensors-by-room" class="floors-container">
            </div>
            <button id="save-vibration-sensor-config" class="save-button" style="margin-top: 12px;">Save Vibration Sensor Configuration</button>
        </div>
        
        <!-- Door Sensors Section -->
        <div class="config-section">
            <h5>Door Sensors</h5>
            <p>Configure door sensors based on Home Assistant labels. Select door sensors labeled "Door" to assign to rooms.</p>
            <div id="door-setup-status" class="status-display">Ready</div>
            <button id="reload-door-sensors" class="action-button">Reload Door Sensors</button>
            <div id="door-sensors-by-room" class="floors-container">
            </div>
            <button id="save-door-sensor-config" class="save-button" style="margin-top: 12px;">Save Door Sensor Configuration</button>
        </div>
        
        <!-- Temperature Sensors Section -->
        <div class="config-section">
            <h5>Temperature Sensors</h5>
            <p>Configure temperature sensors based on Home Assistant labels. Select sensors labeled "Temperatur" to assign to rooms.</p>
            
            <div class="config-section">
                <h6>Global Thresholds</h6>
                <p>Set global thresholds for temperature and humidity notifications.</p>
                <div id="thresholds-config-status" class="status-display">Ready</div>
                <div class="setting-row">
                    <label for="global-temp-threshold" style="width: 100px;">Temperature:</label>
                    <input type="number" id="global-temp-threshold" class="form-input" placeholder="e.g., 30">
                </div>
                <div class="setting-row" style="margin-top: 8px;">
                    <label for="global-humidity-threshold" style="width: 100px;">Humidity:</label>
                    <input type="number" id="global-humidity-threshold" class="form-input" placeholder="e.g., 70">
                </div>
                <button id="save-thresholds-config" class="save-button" style="margin-top: 12px;">Save Thresholds</button>
            </div>
            
            <div id="temperatur-setup-status" class="status-display">Ready</div>
            <button id="reload-temperatur-sensors" class="action-button">Reload Temperature Sensors</button>
            <div id="temperatur-sensors-by-room" class="floors-container">
            </div>
            <button id="save-temperatur-sensor-config" class="save-button" style="margin-top: 12px;">Save Temperature Sensor Configuration</button>
        </div>
        
        <!-- Humidity Sensors Section -->
        <div class="config-section">
            <h5>Humidity Sensors</h5>
            <p>Configure humidity sensors based on Home Assistant labels. Select sensors labeled "Humidity" to assign to rooms.</p>
            <div id="humidity-setup-status" class="status-display">Ready</div>
            <button id="reload-humidity-sensors" class="action-button">Reload Humidity Sensors</button>
            <div id="humidity-sensors-by-room" class="floors-container">
            </div>
            <button id="save-humidity-sensor-config" class="save-button" style="margin-top: 12px;">Save Humidity Sensor Configuration</button>
        </div>
    </div>

    <div id="device-management-tab" class="tab-content">
        <h4>Device Management</h4>
        <p>Configure all device types from Home Assistant. Manage lights, covers, and media players in one place.</p>
        
        <!-- Light Setup Section -->
        <div class="config-section">
            <h5>Light Setup</h5>
            <p>Configure light entities from Home Assistant. Select lights to assign to rooms in DashView.</p>
            <div id="light-setup-status" class="status-display">Ready</div>
            <button id="reload-light-entities" class="action-button">Reload Lights</button>
            <div id="lights-by-room" class="floors-container">
            </div>
            <button id="save-light-config" class="save-button" style="margin-top: 12px;">Save Light Configuration</button>
        </div>
        
        <!-- Cover Setup Section -->
        <div class="config-section">
            <h5>Cover Setup</h5>
            <p>Configure cover entities from Home Assistant. Select covers to assign to rooms in DashView.</p>
            <div id="cover-setup-status" class="status-display">Ready</div>
            <button id="reload-cover-entities" class="action-button">Reload Covers</button>
            <div id="covers-by-room" class="floors-container">
            </div>
            <button id="save-cover-config" class="save-button" style="margin-top: 12px;">Save Cover Configuration</button>
        </div>
        
        <!-- Media Player Setup Section -->
        <div class="config-section">
            <h5>Media Player Management</h5>
            <p>Assign each available media player from Home Assistant to one of your configured rooms.</p>
            <div id="media-player-status" class="status-display">Ready</div>
            <button id="reload-media-players" class="action-button">Reload Rooms & Players</button>
            <div id="media-player-assignment-list" class="floors-container">
            </div>
            <button id="save-all-media-assignments" class="save-button" style="margin-top: 20px;">Save All Assignments</button>
        </div>
    </div>



    <div id="room-maintenance-tab" class="tab-content">
        <h4>Room Maintenance</h4>
        <p>Assign a combined activity sensor to each of your Home Assistant rooms.</p>

        <div class="config-section">
            <h5>Room Maintenance Status</h5>
            <div id="room-maintenance-status" class="status-display">Ready</div>
            <button id="reload-room-maintenance" class="action-button">Reload Rooms</button>
        </div>

        <div class="config-section">
            <h5>Configured Rooms</h5>
            <div id="rooms-list" class="floors-container">
                </div>
        </div>
    </div>
    <div id="integrations-tab" class="tab-content">
        <h4>Integrations</h4>
        <p>Configure entities from third-party integrations.</p>
        <div class="config-section">
            <h5>DWD Weather Warning</h5>
            <p>Select your DWD (Deutscher Wetterdienst) warning level sensor from the list of available entities.</p>
            <div id="dwd-config-status" class="status-display">Ready</div>
            <div class="setting-row">
                <select id="dwd-weather-warnings-selector" class="dropdown-selector"></select>
                <button id="save-dwd-config" class="save-button">Save</button>
                <button id="reload-dwd-config" class="action-button">Reload</button>
            </div>
        </div>
    </div>
    <div id="header-buttons-tab" class="tab-content">
        <h4>Header Buttons Configuration (Legacy)</h4>
        <p>Configure floor and room settings for the header buttons display. This is the legacy configuration method.</p>
        
        <div class="config-section">
            <h5>Configuration Files Status</h5>
            <div id="config-status" class="status-display">Loading...</div>
            <button id="reload-config" class="action-button">Reload Configuration</button>
        </div>
        
        <div class="config-section">
            <h5>Floor Configuration</h5>
            <textarea id="floors-config" class="config-textarea" placeholder="Floor configuration will be loaded here..."></textarea>
            <button id="save-floors-config" class="save-button">Save Floors Config</button>
        </div>
        
        <div class="config-section">
            <h5>Room Configuration</h5>
            <textarea id="rooms-config" class="config-textarea" placeholder="Room configuration will be loaded here..."></textarea>
            <button id="save-rooms-config" class="save-button">Save Rooms Config</button>
        </div>
    </div>

    <div id="other-entities-tab" class="tab-content">
        <h4>Other Entities Management</h4>
        <p>Configure and manage additional entity types for your dashboard. These entities will be saved to your house configuration and can be used in sensor cards.</p>
        
        <div class="config-section">
            <h5>Hoover Entities</h5>
            <p>Add vacuum cleaner and robotic hoover entities to your rooms. These will appear in sensor cards with dynamic icons and background coloring.</p>
            <div id="hoover-setup-status" class="status-display">Ready</div>
            <div id="hoover-entities-list" class="floors-container">
                <!-- Hoover entities will be rendered here -->
            </div>
            <div class="form-row" style="margin-top: 20px; display: grid; grid-template-columns: 2fr 3fr 1fr; gap: 12px;">
                <select id="new-hoover-room" class="dropdown-selector">
                    <option value="">Select Room</option>
                </select>
                <select id="new-hoover-entity" class="dropdown-selector">
                    <option value="">Select Vacuum Entity</option>
                </select>
                <button id="add-hoover-entity" class="action-button">Add</button>
            </div>
            <button id="save-hoover-entities" class="save-button" style="margin-top: 12px;">Save Hoover Configuration</button>
        </div>

        <div class="config-section">
            <h5>Mower Entities</h5>
            <p>Add lawn mower and robotic mower entities to your rooms. These will appear in sensor cards with dynamic icons and background coloring.</p>
            <div id="mower-setup-status" class="status-display">Ready</div>
            <div id="mower-entities-list" class="floors-container">
                <!-- Mower entities will be rendered here -->
            </div>
            <div class="form-row" style="margin-top: 20px; display: grid; grid-template-columns: 2fr 3fr 1fr; gap: 12px;">
                <select id="new-mower-room" class="dropdown-selector">
                    <option value="">Select Room</option>
                </select>
                <select id="new-mower-entity" class="dropdown-selector">
                    <option value="">Select Vacuum Entity</option>
                </select>
                <button id="add-mower-entity" class="action-button">Add</button>
            </div>
            <button id="save-mower-entities" class="save-button" style="margin-top: 12px;">Save Mower Configuration</button>
        </div>

        <div class="config-section">
            <h5>Door Entities</h5>
            <p>Add additional door entities manually to your rooms. These will appear in sensor cards with dynamic icons and background coloring.</p>
            <div id="other-door-setup-status" class="status-display">Ready</div>
            <div id="other-door-entities-list" class="floors-container">
                <!-- Door entities will be rendered here -->
            </div>
            <div class="form-row" style="margin-top: 20px; display: grid; grid-template-columns: 2fr 3fr 1fr; gap: 12px;">
                <select id="new-other-door-room" class="dropdown-selector">
                    <option value="">Select Room</option>
                </select>
                <input type="text" id="new-other-door-entity" class="form-input" placeholder="Entity ID (e.g., binary_sensor.front_door)">
                <button id="add-other-door-entity" class="action-button">Add</button>
            </div>
            <button id="save-other-door-entities" class="save-button" style="margin-top: 12px;">Save Door Configuration</button>
        </div>
    </div>

    <div id="garbage-tab" class="tab-content">
        <h4>Garbage Collection Management</h4>
        <p>Configure your garbage collection sensors for display in the floor area. Each sensor will show the next collection date.</p>
        
        <div class="config-section">
            <h5>Garbage Sensors</h5>
            <div id="garbage-setup-status" class="status-display">Ready</div>
            <div id="garbage-sensors-list" class="floors-container">
                <!-- Garbage sensors will be rendered here -->
            </div>
            <div class="form-row" style="margin-top: 20px; display: grid; grid-template-columns: 2fr 2fr 1fr 1fr; gap: 12px;">
                <input type="text" id="new-garbage-sensor" class="form-input" placeholder="Entity ID (e.g., sensor.biomuell)">
                <select id="new-garbage-type" class="dropdown-selector">
                    <option value="">Select Type</option>
                    <option value="biomuell">Biomüll</option>
                    <option value="hausmuell">Hausmüll</option>
                    <option value="gelber_sack">Gelber Sack</option>
                    <option value="altpapier">Altpapier</option>
                    <option value="restmuell">Restmüll</option>
                    <option value="wertstoff">Wertstoff</option>
                    <option value="sondermuell">Sondermüll</option>
                </select>
                <button id="add-garbage-sensor" class="action-button">Add</button>
                <button id="reload-garbage-sensors" class="action-button">Reload</button>
            </div>
            <button id="save-garbage-sensors" class="save-button" style="margin-top: 12px;">Save Garbage Configuration</button>
        </div>
    </div>

    <div class="config-section">
        <h5>Configuration Summary</h5>
        <div id="config-summary-container" class="summary-grid">
            <p>Load a configuration tab to view summary.</p>
        </div>
    </div>
</div>
